(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}})();document.addEventListener("DOMContentLoaded",S);function S(){C(),b(),v(),L(),p()}function p(){const n=document.querySelectorAll(".js-count-cart"),t=m("cart");let e=0;t.forEach(o=>e+=o.price*o.count),n.forEach(o=>{const s=o.parentElement.querySelector(".js-cart-text");o.innerText=t.length??"0",o.classList.toggle("show",!!t.length),s.innerText=t.length?`${e} ₽`:"Корзина"})}function v(){document.querySelectorAll(".js-add-cart").forEach(t=>{t.addEventListener("click",()=>{const e=t.closest(".goods-card"),s=e.getAttributeNames().filter(a=>a.includes("data")),c=s.map(a=>a.replace("data-","")),r=Number(e.querySelector(".js-product-count").value),h=Number(e.getAttribute("data-count")),l=e.querySelector(".js-count-to-cart"),d=(h+r).toString(),u={};e.setAttribute("data-count",d),l.innerText=d,l.parentElement.classList.add("show"),c.forEach((a,w)=>{u[a]=e.getAttribute(s[w])}),y(u),p()})})}function L(){localStorage.cart&&JSON.parse(localStorage.cart).forEach(t=>{const e=document.querySelector(`.goods-card[data-id='${t.id}']`),o=e.querySelector(".js-count-to-cart");e.setAttribute("data-count",t.count),o.innerText=t.count,o.parentElement.classList.add("show")})}function y(n){const t=m("cart");if(t.length){const e=t.findIndex(o=>o.id===n.id);e>=0?t[e]=n:(console.log("23"),t.push(n))}else t.push(n);E("cart",t)}function m(n){const t=localStorage[n];return t?JSON.parse(t):[]}function E(n,t){localStorage[n]=JSON.stringify(t)}function b(){document.querySelectorAll(".js-product-count").forEach(t=>{t.addEventListener("change",()=>{t.value%1>0&&(t.value=Math.floor(t.value)),t.value<0&&(t.value="1")})})}function C(){document.addEventListener("click",n=>{const t=n.target.classList;t.contains("js-card-btn-inc")?f(n.target):t.contains("js-card-btn-dec")&&f(n.target,!1)})}function f(n,t=!0){const e=n.closest(".goods-card-buy__label").querySelector("input");let o=Number(e.value);if(!t&&o-1<1)return!1;e.value=t?(++o).toString():(--o).toString()}window.addEventListener("load",()=>document.body.classList.add("loaded"));document.addEventListener("DOMContentLoaded",()=>{[".js-swiper-goods-new",".js-swiper-goods-promo",".js-swiper-goods-hit"].forEach(t=>A(t)),j()});function j(){N(),O(),k(),q(),x(),P()}function q(){document.querySelectorAll("[data-search]").forEach(t=>{t.addEventListener("input",()=>{let e=(t.value.length>2).toString();t.closest(".header-search").setAttribute("data-hint",e)})})}function x(){const n=document.querySelector(".js-open-catalog"),t=document.querySelector(".catalog-menu-head__close"),e=document.body.classList,o="show-catalog";n.addEventListener("click",()=>e.toggle(o)),t.addEventListener("click",()=>e.remove(o))}function A(n){new Swiper(n,{breakpoints:{320:{slidesPerView:2,spaceBetween:8},576:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1170:{slidesPerView:4,spaceBetween:24}},navigation:{nextEl:".swiper-goods-nav.swiper-button-next",prevEl:".swiper-goods-nav.swiper-button-prev"}})}function N(){const n=document.querySelectorAll(".js-dropdown .nav-link"),t=[...n].map(e=>new bootstrap.Dropdown(e));n.forEach((e,o)=>{const s=e.closest(".js-dropdown");let c;e.addEventListener("mouseenter",()=>{s.classList.add("dropdown-show"),c=setTimeout(()=>{s.classList.contains("dropdown-show")&&t[o].show()},100)}),s.addEventListener("mouseleave",()=>{s.classList.remove("dropdown-show"),clearTimeout(c),t[o].hide()})})}function O(){document.querySelectorAll(".js-catalog-list > li").forEach(t=>{t.addEventListener("mouseenter",()=>{const e=t.getAttribute("data-category"),o=document.querySelector(`.catalog-category-content[data-content-category='${e}']`);o&&(o.classList.add("show"),o.getSiblings().forEach(s=>s.classList.remove("show"))),t.classList.add("active"),t.getSiblings().forEach(s=>s.classList.remove("active"))})})}function P(){document.querySelectorAll(".js-catalog-list-mobile li > a").forEach(t=>{t.addEventListener("click",()=>{const e=t.parentElement;e.getSiblings().forEach(o=>o.classList.remove("is-open")),e.querySelectorAll(".is-open").forEach(o=>{o.classList.remove("is-open")}),e.classList.toggle("is-open")})})}function k(){g(),window.addEventListener("scroll",g)}function g(){matchMedia("(min-width: 992px)").matches&&(scrollY>72?document.body.classList.add("header-fixed"):document.body.classList.remove("header-fixed"))}function i(n,t,e=[]){let o=t?n.nextElementSibling:n.previousElementSibling;return o!=null?(e.push(o),i(o,t,e)):e}Object.prototype.getSiblings=function(){return[...i(this,!1),...i(this,!0)]};
