(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();document.addEventListener("DOMContentLoaded",L);function L(){C(),E(),S(),w(),p()}function p(){const e=document.querySelector(".js-count-cart"),t=e.parentElement.querySelector(".js-cart-text"),o=m("cart");let s=0;e.innerText=o.length??"0",e.classList.toggle("show",!!o.length),o.forEach(n=>s+=n.price*n.count),t.innerText=o.length?`${s} ₽`:"Корзина"}function S(){document.querySelectorAll(".js-add-cart").forEach(t=>{t.addEventListener("click",()=>{const o=t.closest(".goods-card"),n=o.getAttributeNames().filter(a=>a.includes("data")),r=n.map(a=>a.replace("data-","")),c=Number(o.querySelector(".js-product-count").value),h=Number(o.getAttribute("data-count")),d=o.querySelector(".js-count-to-cart"),l=(h+c).toString(),u={};o.setAttribute("data-count",l),d.innerText=l,d.parentElement.classList.add("show"),r.forEach((a,v)=>{u[a]=o.getAttribute(n[v])}),y(u),p()})})}function w(){localStorage.cart&&JSON.parse(localStorage.cart).forEach(t=>{const o=document.querySelector(`.goods-card[data-id='${t.id}']`),s=o.querySelector(".js-count-to-cart");o.setAttribute("data-count",t.count),s.innerText=t.count,s.parentElement.classList.add("show")})}function y(e){const t=m("cart");if(t.length){const o=t.findIndex(s=>s.id===e.id);o>=0?t[o]=e:(console.log("23"),t.push(e))}else t.push(e);b("cart",t)}function m(e){const t=localStorage[e];return t?JSON.parse(t):[]}function b(e,t){localStorage[e]=JSON.stringify(t)}function E(){document.querySelectorAll(".js-product-count").forEach(t=>{t.addEventListener("change",()=>{t.value%1>0&&(t.value=Math.floor(t.value)),t.value<0&&(t.value="1")})})}function C(){document.addEventListener("click",e=>{const t=e.target.classList;t.contains("js-card-btn-inc")?f(e.target):t.contains("js-card-btn-dec")&&f(e.target,!1)})}function f(e,t=!0){const o=e.closest(".goods-card-buy__label").querySelector("input");let s=Number(o.value);if(!t&&s-1<1)return!1;o.value=t?(++s).toString():(--s).toString()}window.addEventListener("load",()=>document.body.classList.add("loaded"));document.addEventListener("DOMContentLoaded",()=>{[".js-swiper-goods-new",".js-swiper-goods-promo",".js-swiper-goods-hit"].forEach(t=>A(t)),j()});function j(){N(),O(),k(),x(),q()}function x(){const e=document.getElementById("search");e.addEventListener("input",()=>{let t=(e.value.length>2).toString();e.closest(".header-search").setAttribute("data-hint",t)})}function q(){document.querySelector(".js-open-catalog").addEventListener("click",()=>document.body.classList.toggle("show-catalog"))}function A(e){new Swiper(e,{breakpoints:{1270:{slidesPerView:4,spaceBetween:24}},navigation:{nextEl:".swiper-goods-nav.swiper-button-next",prevEl:".swiper-goods-nav.swiper-button-prev"}})}function N(){const e=document.querySelectorAll(".js-dropdown .nav-link"),t=[...e].map(o=>new bootstrap.Dropdown(o));e.forEach((o,s)=>{const n=o.closest(".js-dropdown");let r;o.addEventListener("mouseenter",()=>{n.classList.add("dropdown-show"),r=setTimeout(()=>{n.classList.contains("dropdown-show")&&t[s].show()},200)}),n.addEventListener("mouseleave",()=>{n.classList.remove("dropdown-show"),clearTimeout(r),t[s].hide()})})}function O(){document.querySelectorAll(".js-catalog-list > li").forEach(t=>{t.addEventListener("mouseenter",()=>{const o=t.getAttribute("data-category"),s=document.querySelector(`.catalog-category-content[data-content-category='${o}']`);s&&(s.classList.add("show"),s.getSiblings().forEach(n=>n.classList.remove("show"))),t.classList.add("active"),t.getSiblings().forEach(n=>n.classList.remove("active"))})})}function k(){g(),window.addEventListener("scroll",g)}function g(){console.log(scrollY),scrollY>72?document.body.classList.add("header-fixed"):document.body.classList.remove("header-fixed")}function i(e,t,o=[]){let s=t?e.nextElementSibling:e.previousElementSibling;return s!=null?(o.push(s),i(s,t,o)):o}Object.prototype.getSiblings=function(){return[...i(this,!1),...i(this,!0)]};
