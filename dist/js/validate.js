(()=>{const o={name:"name",email:"email",phone:"phone",password:"password",passwordAccept:"password-accept",INN:"INN",KPP:"KPP",OGRN:"OGRN",subscribe:"subscribe",nameOrganization:"nameOrganization",privacy:"privacy"},s={ERROR_REQUIRED:"Обязательное поле",ERROR_EMAIL:"Введите корректный email",ERROR_PHONE:"Заполните телефон полностью",ERROR_MIN_LENGTH:e=>`Поле должно содержать не менее ${e} символов`,ERROR_MIN_LENGTH_DATA:(e,t)=>`${t} должно состоять из ${e} символов`},r={[o.name]:{valueMissing:s.ERROR_REQUIRED},[o.email]:{valueMissing:s.ERROR_REQUIRED,typeMismatch:s.ERROR_EMAIL,customError:s.ERROR_EMAIL},[o.phone]:{valueMissing:s.ERROR_REQUIRED,customError:s.ERROR_PHONE},[o.password]:{valueMissing:s.ERROR_REQUIRED,tooShort:s.ERROR_MIN_LENGTH(6)},[o.INN]:{valueMissing:s.ERROR_REQUIRED,tooShort:s.ERROR_MIN_LENGTH_DATA(12,"ИНН")},[o.KPP]:{valueMissing:s.ERROR_REQUIRED,tooShort:s.ERROR_MIN_LENGTH_DATA(9,"КПП")},[o.OGRN]:{valueMissing:s.ERROR_REQUIRED,tooShort:s.ERROR_MIN_LENGTH_DATA(13,"ОГРН")},[o.nameOrganization]:{valueMissing:s.ERROR_REQUIRED},[o.passwordAccept]:{valueMissing:s.ERROR_REQUIRED,tooShort:s.ERROR_MIN_LENGTH(6)}};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".js-form");e==null||e.forEach(n=>d(n)),E(),l(),document.querySelectorAll(".form-input input").forEach(n=>{n.addEventListener("input",()=>R(n))})});function l(){const e=document.querySelector(`input[name=${o.phone}]`),t=document.querySelector(`input[name=${o.KPP}]`),n=document.querySelector(`input[name=${o.OGRN}]`);e&&IMask(e,{mask:"+7(000)000-00-00",prepare:(i,a)=>!a.value&&i==="8"?"+7":i}),t&&IMask(t,{mask:"000000000"}),n&&IMask(n,{mask:/^[15]\d{0,12}$/}),u()}function u(){const e=document.querySelector(`input[name=${o.INN}]`);if(e){const t=document.querySelectorAll("[name=legal-form]"),n={count:12,mask:"000000000000"},i=IMask(e,{mask:n.mask});e.setAttribute("minlength",n.count),t.forEach(a=>{a.addEventListener("change",()=>{const c=a.value==="type-1";n.mask=c?"000000000000":"0000000000",n.count=c?12:10,e.setAttribute("minlength",n.count),i.mask=n.mask,r[o.INN].tooShort=s.ERROR_MIN_LENGTH_DATA(n.count,"ИНН"),i.value=""})})}}function E(){document.querySelectorAll(".form-input input").forEach(t=>{t.addEventListener("change",()=>{t.closest(".form-input").classList.toggle("fill",t.value.length)})})}function d(e){e.addEventListener("submit",t=>{t.preventDefault(),m(e),e.checkValidity()?console.log("send"):e.classList.add("was-validated")},!1)}function m(e){for(const t of e.elements)R(t)}function R(e){const t=e.getAttribute("name");Object.keys(r).includes(t)&&(N(e,t),Object.keys(ValidityState.prototype).forEach(i=>{if(e.validity[i]){const a=e.closest(".form-input");a.querySelector(".invalid-feedback")||a.insertAdjacentHTML("beforeend",'<div class="invalid-feedback"></div>');const c=a.querySelector(".invalid-feedback");c.textContent=r[e.name][i]}}))}function N(e,t){if(t===o.phone){const n=!e.validity.valueMissing&&e.value.length<16;e.setCustomValidity(n?"Incorrect phone":"")}else if(t===o.email){const n=!e.validity.valueMissing&&!e.value.includes(".");e.setCustomValidity(n?"Incorrect email":"")}}})();
