(()=>{const s={name:"name",email:"email",phone:"phone",password:"password",passwordAccept:"password-accept",INN:"INN",KPP:"KPP",OGRN:"OGRN",subscribe:"subscribe",nameOrganization:"nameOrganization",privacy:"privacy",legalForm:"legal-form",address:"address"},n={ERROR_REQUIRED:"Обязательное поле",ERROR_EMAIL:"Введите корректный email",ERROR_PHONE:"Заполните телефон полностью",ERROR_PASSWORD_ACCEPT:"Пароли не совпадают",ERROR_MIN_LENGTH:e=>`Поле должно содержать не менее ${e} символов`,ERROR_MIN_LENGTH_DATA:(e,o)=>`${o} должно состоять из ${e} символов`},c={[s.name]:{valueMissing:n.ERROR_REQUIRED},[s.email]:{valueMissing:n.ERROR_REQUIRED,typeMismatch:n.ERROR_EMAIL,customError:n.ERROR_EMAIL},[s.phone]:{valueMissing:n.ERROR_REQUIRED,customError:n.ERROR_PHONE},[s.password]:{valueMissing:n.ERROR_REQUIRED,tooShort:n.ERROR_MIN_LENGTH(6)},[s.INN]:{valueMissing:n.ERROR_REQUIRED,tooShort:n.ERROR_MIN_LENGTH_DATA(12,"ИНН")},[s.KPP]:{valueMissing:n.ERROR_REQUIRED,tooShort:n.ERROR_MIN_LENGTH_DATA(9,"КПП")},[s.OGRN]:{valueMissing:n.ERROR_REQUIRED,tooShort:n.ERROR_MIN_LENGTH_DATA(13,"ОГРН")},[s.nameOrganization]:{valueMissing:n.ERROR_REQUIRED},[s.passwordAccept]:{valueMissing:n.ERROR_REQUIRED,customError:n.ERROR_PASSWORD_ACCEPT,tooShort:n.ERROR_MIN_LENGTH(6)},[s.address]:{valueMissing:n.ERROR_REQUIRED}};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".js-form");e==null||e.forEach(o=>f(o)),p(),E(),d(),u()});function u(){const e=document.querySelectorAll(".form-input input"),o=document.querySelectorAll(".form-textarea textarea");e.forEach(t=>{t.addEventListener("input",()=>l(t))}),o.forEach(t=>{t.addEventListener("input",()=>l(t))})}function d(){var t;const e=document.querySelector(".js-password-display"),o=(t=e==null?void 0:e.closest(".form-input"))==null?void 0:t.querySelector("input");e==null||e.addEventListener("click",()=>{e.classList.toggle("show-pass");const a=e.classList.contains("show-pass")?"text":"password";o.setAttribute("type",a)})}function E(){const e=document.querySelector(`input[name=${s.phone}]`),o=document.querySelector(`input[name=${s.KPP}]`),t=document.querySelector(`input[name=${s.OGRN}]`);e&&IMask(e,{mask:"+7(000)000-00-00",prepare:(a,i)=>!i.value&&a==="8"?"+7":a}),o&&IMask(o,{mask:"000000000"}),t&&IMask(t,{mask:/^[15]\d{0,12}$/}),m()}function m(){const e=document.querySelector(`input[name=${s.INN}]`);if(e){const o=document.querySelectorAll(`[name=${s.legalForm}]`),t={count:12,mask:"000000000000"},a=IMask(e,{mask:t.mask});e.setAttribute("minlength",t.count),o.forEach(i=>{i.addEventListener("change",()=>{const r=i.value==="type-1";t.mask=r?"000000000000":"0000000000",t.count=r?12:10,e.setAttribute("minlength",t.count),a.mask=t.mask,c[s.INN].tooShort=n.ERROR_MIN_LENGTH_DATA(t.count,"ИНН"),a.value=""})})}}function p(){const e=document.querySelectorAll(".form-input input"),o=document.querySelectorAll(".form-textarea textarea");e.forEach(t=>R(t,".form-input")),o.forEach(t=>R(t,".form-textarea"))}function R(e,o){e.addEventListener("change",()=>{e.closest(o).classList.toggle("fill",e.value.length)})}function f(e){e.addEventListener("submit",o=>{o.preventDefault(),I(e),e.checkValidity()?(console.log("send"),e.querySelector("[type=submit]").setAttribute("disabled","disabled")):(e.classList.add("was-validated"),v(e))},!1)}function v(e){const o=e.querySelector("input:invalid"),t=o==null?void 0:o.getBoundingClientRect().top;scrollBy({top:t-100,behavior:"smooth"})}function I(e){for(const o of e.elements)l(o)}function l(e){const o=e.getAttribute("name");Object.keys(c).includes(o)&&(N(e,o),Object.keys(ValidityState.prototype).forEach(a=>{if(e.validity[a]){const i=e.closest(e.tagName==="TEXTAREA"?".form-textarea":".form-input");i.querySelector(".invalid-feedback")||i.insertAdjacentHTML("beforeend",'<div class="invalid-feedback"></div>');const r=i.querySelector(".invalid-feedback");r.textContent=c[e.name][a]}}))}function N(e,o){if(o===s.phone){const t=!e.validity.valueMissing&&e.value.length<16;e.setCustomValidity(t?"Incorrect phone":"")}else if(o===s.email){const t=!e.validity.valueMissing&&!e.value.includes(".");e.setCustomValidity(t?"Incorrect email":"")}else if(o===s.passwordAccept){const t=document.querySelector(`input[name=${s.password}]`),a=!e.validity.valueMissing&&e.value!==t.value;e.setCustomValidity(a?"Incorrect email":"")}}})();
