(()=>{document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".js-form"),t={ERROR_REQUIRED:"Обязательное поле",ERROR_EMAIL:"Введите корректный email",ERROR_PHONE:"Заполните телефон полностью",ERROR_MIN_LENGTH:o=>`Поле должно содержать не менее ${o} символов`,ERROR_MIN_LENGTH_INN:o=>`ИНН должно состоять из ${o} символов`},n={name:"name",email:"email",phone:"phone",password:"password",INN:"INN",KPP:"KPP",OGRN:"OGRN"},s={[n.name]:{valueMissing:t.ERROR_REQUIRED},[n.email]:{valueMissing:t.ERROR_REQUIRED,typeMismatch:t.ERROR_EMAIL},[n.phone]:{valueMissing:t.ERROR_REQUIRED,customError:t.ERROR_PHONE},[n.password]:{valueMissing:t.ERROR_REQUIRED,tooShort:t.ERROR_MIN_LENGTH(6)},[n.INN]:{tooShort:t.ERROR_MIN_LENGTH_INN(12)},[n.KPP]:{tooShort:t.ERROR_MIN_LENGTH_INN(9)},[n.OGRN]:{tooShort:t.ERROR_MIN_LENGTH_INN(13)}};e==null||e.forEach(o=>{c(o,s)}),R(),r(),document.querySelectorAll(".form-input input").forEach(o=>{o.addEventListener("input",()=>i(o,s))})});function r(){const e=document.querySelector("input[name=phone]"),t=document.querySelector("input[name=INN]"),n=document.querySelector("input[name=OGRN]"),s=document.querySelector("input[name=KPP]");IMask(e,{mask:"+7(000)000-00-00",prepare:(a,o)=>!o.value&&a==="8"?"+7":a}),IMask(t,{mask:"000000000000"}),IMask(n,{mask:"0000000000000"}),IMask(s,{mask:"000000000"})}function R(){document.querySelectorAll(".form-input input").forEach(t=>{t.addEventListener("change",()=>{t.closest(".form-input").classList.toggle("fill",t.value.length)})})}function c(e,t){e.addEventListener("submit",n=>{n.preventDefault(),e.classList.remove("was-validated");const s=e.querySelector("[name=main-fields]");l(s,t),e.classList.add("was-validated")},!1)}function l(e,t){for(const n of e.elements)i(n,t)}function i(e,t){if(e.getAttribute("name")==="phone"){const n=!e.validity.valueMissing&&e.value.length<16;e.setCustomValidity(n?"Incorrect phone":"")}Object.keys(ValidityState.prototype).forEach(n=>{e!=null&&e.validity[n]&&(e.closest(".form-input").querySelector(".invalid-feedback").textContent=t[e.name][n])})}})();
